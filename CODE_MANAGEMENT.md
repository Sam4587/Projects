# 🎯 随礼那点事儿 - 代码管理规范

## 📋 项目概述

**项目名称**：随礼那点事儿（原：红包装潢助手）  
**项目类型**：微信小程序 - 纯前端版本  
**当前版本**：v1.0.0  
**技术栈**：微信小程序原生开发 + ES6 + WXML/WXSS  

## 🌿 版本管理策略

### 分支管理

```
main           # 主分支，生产环境代码
├── release/   # 发布分支前缀
├── feature/   # 功能开发分支前缀
└── hotfix/    # 紧急修复分支前缀
```

### 版本号规范

采用语义化版本号：`MAJOR.MINOR.PATCH`

- **MAJOR**：重大功能更新，架构调整
- **MINOR**：新功能添加，向下兼容
- **PATCH**：Bug修复，优化改进

### 当前版本历史

| 版本 | 日期 | 类型 | 说明 |
|------|------|------|------|
| v1.0.0 | 2026-01-30 | 正式版 | 包含3大核心功能，质量检查100%通过 |

## 🛠️ 开发规范

### 代码结构规范

```
redpacket-advisor/
├── pages/                    # 页面文件
│   ├── calculator/         # 随礼计算器
│   ├── translator/         # 红包翻译器
│   ├── customs/            # 地域习俗
│   └── stats/              # 数据统计
├── components/             # 公共组件
│   └── feedback/           # 用户反馈组件
├── config/                 # 配置文件
│   ├── blessings/          # 祝福语数据
│   ├── customs/            # 地域习俗数据
│   └── version-1-initial-data*.js
├── utils/                  # 工具函数
├── src/                    # 源代码(Web版本相关)
└── assets/                 # 静态资源
```

### 命名规范

#### 文件命名
- 页面文件：小写字母，多个单词用连字符连接
- 组件文件：小写字母，多个单词用连字符连接
- JavaScript：camelCase
- JSON配置：与页面同名

#### 变量命名
- 使用有意义的英文名称
- 布尔值前缀：`is`, `has`, `can`
- 数组后缀：`List`, `Array`
- 常量：大写字母 + 下划线

#### 函数命名
- 动词开头：`get`, `set`, `handle`, `calculate`
- 事件处理：`on` + 事件名
- 生命周期：`onLoad`, `onShow`, `onHide`

### 代码质量要求

#### 1. 语法规范
- 使用ES6+语法
- 启用严格模式
- 避免全局变量污染

#### 2. 错误处理
- 所有异步操作必须有错误处理
- 关键函数需要参数验证
- 空值检查（防御性编程）

#### 3. 性能优化
- 避免频繁的setData操作
- 合理使用数据缓存
- 组件按需加载

## 🔄 开发流程

### 新功能开发

1. **需求分析** - 明确功能目标和验收标准
2. **分支创建** - `git checkout -b feature/功能名称`
3. **代码实现** - 遵循开发规范
4. **自测验证** - 功能测试+边界情况测试
5. **代码审查** - 提交PR，团队review
6. **合并发布** - 合并到main分支，打版本标签

### Bug修复流程

1. **问题定位** - 复现问题，定位原因
2. **分支创建** - `git checkout -b hotfix/问题简述`
3. **修复验证** - 确保修复有效且不引入新问题
4. **紧急发布** - 快速合并并发布补丁版本

### 发布流程

1. **代码检查** - 确保通过微信小程序代码检查
2. **功能测试** - 所有核心功能正常工作
3. **性能测试** - 页面加载、响应时间达标
4. **版本提交** - 提交到微信小程序后台
5. **标签创建** - 在Git中创建对应版本标签

## 📊 版本发布记录

### v1.0.0 (2026-01-30)

**🎉 正式发布**

#### 核心功能
- ✅ 随礼计算器：支持关系/亲疏双重维度计算
- ✅ 红包翻译器：传统祝福语转现代白话
- ✅ 地域习俗库：34个地区完整风俗数据
- ✅ 用户反馈系统：本地存储+钉钉集成

#### 质量保障
- ✅ 代码质量检查100%通过
- ✅ 修复空值访问等高风险Bug
- ✅ 完善错误处理和降级机制
- ✅ 增强用户输入验证

#### 技术特性
- ✅ 纯前端实现，无需后端依赖
- ✅ 模块化数据管理，支持按需加载
- ✅ 完整的生命周期管理
- ✅ 性能和稳定性优化

## 🎛️ 配置管理

### 环境配置

```javascript
// app.json - 应用配置
{
  "pages": [...],
  "window": {...},
  "tabBar": {...},
  "version": "1.0.0"
}

// project.config.json - 项目配置
{
  "setting": {
    "libVersion": "3.14.1",
    "nodeModules": false
  }
}
```

### 数据版本管理

```javascript
// config/version-1-initial-data.js
const INITIAL_DATA_VERSION = "1.0.20250131";

module.exports = {
  INITIAL_DATA_VERSION,
  regionsData,
  categories,
  blessingPhrases,
  customsData
};
```

## 🔒 安全管理

### 数据安全
- 所有数据存储在客户端本地
- 无敏感信息硬编码
- 用户隐私保护

### 代码安全
- 禁用eval等危险函数
- 输入参数验证和过滤
- 异常情况降级处理

## 📈 后续迭代规划

### 短期目标 (v1.x)
1. **v1.1.0** - 添加云开发版本，支持数据同步
2. **v1.2.0** - 集成AI智能翻译功能
3. **v1.3.0** - 添加更多地域方言支持

### 长期目标 (v2.x)
1. **v2.0.0** - 重构为全栈应用，支持用户账户系统
2. **v2.1.0** - 添加社交功能，支持分享和讨论
3. **v2.2.0** - 多端统一，支持Web和App版本

## 🤝 协作规范

### Git提交信息规范

```
<类型>(<范围>): <主题>

<正文>

<页脚>
```

**类型**：
- `feat`：新功能
- `fix`：Bug修复
- `docs`：文档更新
- `style`：代码格式调整
- `refactor`：重构
- `test`：测试相关
- `chore`：构建过程或辅助工具的变动

### 代码审查要点

1. **功能性** - 功能是否按需求实现
2. **健壮性** - 是否有足够的错误处理
3. **性能** - 是否存在性能问题
4. **安全** - 是否有安全隐患
5. **可读性** - 代码是否清晰易懂

---

**📝 维护记录**
- 2026-01-30: 创建代码管理规范 v1.0
- 随礼那点事儿项目组维护更新
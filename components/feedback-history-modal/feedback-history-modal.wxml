<!-- components/feedback-history-modal/feedback-history-modal.wxml -->
<view class="feedback-history-modal" wx:if="{{showModal}}">
  <!-- é®ç½©å±‚ -->
  <view class="modal-mask" bindtap="handleMaskTap"></view>

  <!-- å¼¹çª—å†…å®¹ -->
  <view class="modal-content" catchtap="stopPropagation">
    <!-- å¼¹çª—æ ‡é¢˜ -->
    <view class="modal-header">
      <text class="modal-title">æˆ‘çš„åé¦ˆè®°å½•</text>
      <text class="modal-close" bindtap="handleClose">âœ•</text>
    </view>

    <!-- åé¦ˆåˆ—è¡¨ -->
    <scroll-view class="history-scroll" scroll-y="true">
      <view class="history-list">
        <block wx:if="{{history.length > 0}}">
          <view
            class="history-item {{item.status === 'failed' ? 'item-failed' : ''}}"
            wx:for="{{historyItem in history}}"
            wx:key="historyItem.id"
            bindtap="handleItemClick"
            data-id="{{historyItem.id}}"
          >
            <!-- åé¦ˆæ—¶é—´å’ŒçŠ¶æ€ -->
            <view class="item-header">
              <view class="item-time">
                <text class="time-text">{{item.submitTime}}</text>
              </view>
              <view class="item-status">
                <text wx:if="{{item.status === 'success'}}" class="status-success">âœ“ å·²å‘é€</text>
                <text wx:if="{{item.status === 'failed'}}" class="status-failed">âœ— å‘é€å¤±è´¥</text>
                <text wx:if="{{item.status === 'pending'}}" class="status-pending">â³ ç­‰å¾…ä¸­</text>
              </view>
            </view>

            <!-- åé¦ˆå†…å®¹ -->
            <view class="item-content">
              <view class="content-rating">
                <text class="rating-icon">â­</text>
                <text class="rating-text">{{item.rating}}</text>
              </view>
              <view class="content-type">
                <text class="type-label">ç±»å‹:</text>
                <text class="type-value">{{item.typeLabel}}</text>
              </view>
              <view class="content-text">
                <text class="text-label">å†…å®¹:</text>
                <text class="text-value">{{item.content}}</text>
              </view>
            </view>

            <!-- æ“ä½œæŒ‰é’® -->
            <view class="item-actions">
              <button
                class="action-btn btn-retry"
                wx:if="{{item.status === 'failed'}}"
                bindtap="handleRetry"
                data-id="{{historyItem.id}}"
              >
                é‡æ–°å‘é€
              </button>
              <button
                class="action-btn btn-delete"
                bindtap="handleDelete"
                data-id="{{historyItem.id}}"
              >
                åˆ é™¤
              </button>
            </view>
          </view>
        </block>

        <!-- ç©ºçŠ¶æ€ -->
        <view wx:if="{{history.length === 0}}" class="empty-state">
          <text class="empty-icon">ğŸ“</text>
          <text class="empty-text">æš‚æ— åé¦ˆè®°å½•</text>
        </view>
      </view>
    </scroll-view>

    <!-- åº•éƒ¨æŒ‰é’® -->
    <view class="modal-footer">
      <button class="btn btn-secondary" bindtap="handleClearAll">æ¸…ç©ºè®°å½•</button>
      <button class="btn btn-primary" bindtap="handleClose">å…³é—­</button>
    </view>
  </view>
</view>

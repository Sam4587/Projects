# 代码下载和测试指南

> 最后更新: 2026-02-05
> 适用版本: v1.0.0

---

## 📥 下载代码到本地

### 方法一: 直接下载(推荐)

**步骤**:

1. **在MonkeyCode平台导出代码**
   - 进入项目页面
   - 点击"下载代码"或"导出代码"按钮
   - 选择导出格式(推荐: ZIP压缩包)
   - 等待下载完成

2. **解压到本地目录**
   ```bash
   # 解压到指定目录
   unzip 随礼那点事儿.zip -d ~/projects/
   cd ~/projects/随礼那点事儿
   ```

3. **检查文件结构**
   ```bash
   # 确认文件完整性
   ls -la
   # 应该看到以下关键目录:
   # - pages/ (页面文件)
   # - components/ (组件)
   # - utils/ (工具类)
   # - config/ (配置)
   # - docs/ (文档)
   ```

### 方法二: 使用Git克隆

如果项目有Git仓库,可以直接克隆:

```bash
# 克隆仓库
git clone <仓库地址> ~/projects/随礼那点事儿

# 进入项目目录
cd ~/projects/随礼那点事儿

# 切换到最新分支
git checkout main

# 查看最新提交
git log -1 --oneline
```

---

## 🛠️ 配置微信开发者工具

### 1. 安装微信开发者工具

1. **下载安装包**
   - 访问: https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
   - 选择对应平台版本(Windows/Mac/Linux)

2. **安装并启动**
   - 运行安装程序
   - 扫码登录微信开发者账号

### 2. 导入项目

1. **打开微信开发者工具**
2. **导入项目**
   - 点击"导入项目"按钮
   - 选择下载解压后的项目目录
   - 或者点击"导入Git仓库"直接克隆

3. **选择项目类型**
   - 选择"小程序"
   - AppID填入你的测试AppID(如果有的话)
   - 项目名称自动填入: 随礼那点事儿

### 3. 项目配置检查

导入后,检查以下配置:

**app.json配置**:
```json
{
  "pages": [
    "pages/calculator/calculator",
    "pages/translator/translator",
    "pages/customs/customs",
    "pages/stats/stats"
  ],
  "window": {
    "navigationBarBackgroundColor": "#dc2626",
    "navigationBarTitleText": "随礼那点事儿"
  },
  "style": "v2",
  "lazyCodeLoading": "requiredComponents"
}
```

**project.config.json配置**:
```json
{
  "appid": "你的AppID",
  "projectname": "随礼那点事儿",
  "compileType": "miniprogram",
  "libVersion": "3.14.1"
}
```

---

## 🧪 测试现有功能

### 测试清单

#### 阶段一: 基础功能测试

**1. 计算器页面** (`pages/calculator/calculator`)
- [ ] 页面可以正常打开
- [ ] 选择关系类型(family/friend/colleague/boss)
- [ ] 选择亲疏程度(acquaintance/normal/close/very-close)
- [ ] 点击"计算金额"按钮
- [ ] 验证推荐金额显示
- [ ] 验证金额范围(low-high)显示
- [ ] 验证推荐说明文字
- [ ] 输入实际金额并提交反馈
- [ ] 验证反馈成功提示

**2. 翻译器页面** (`pages/translator/translator`)
- [ ] 页面可以正常打开
- [ ] 查看默认祝福语列表
- [ ] 切换不同分类(马年专属/通用祝福等)
- [ ] 在输入框输入祝福语
- [ ] 点击"翻译"按钮
- [ ] 验证翻译结果显示
- [ ] 点击复制按钮,验证复制功能
- [ ] 从列表中选择祝福语
- [ ] 验证选择成功提示

**3. 地域习俗页面** (`pages/customs/customs`)
- [ ] 页面可以正常打开
- [ ] 查看省份列表
- [ ] 切换picker,选择不同省份
- [ ] 验证省份切换功能正常(之前报错的修复)
- [ ] 查看该省份的红包金额习俗
- [ ] 查看该省份的送礼习俗
- [ ] 查看该省份的特色说明

**4. 统计页面** (`pages/stats/stats`)
- [ ] 页面可以正常打开
- [ ] 查看统计数据概览
- [ ] 切换不同标签(概览/反馈/事件/性能)

#### 阶段二: 性能测试

**页面加载速度测试**:
- [ ] 计算器页面打开速度(应<1秒,已优化)
- [ ] 翻译器页面打开速度(应<1秒,已优化)
- [ ] 地域习俗页面打开速度(应<1秒,已优化)
- [ ] 统计页面打开速度(应<1秒,已优化)

**搜索性能测试**:
- [ ] 祝福语搜索响应速度(应<10ms,已优化)
- [ ] 输入时无卡顿(已添加防抖)
- [ ] 快速连续输入测试

#### 阶段三: 兼容性测试

**设备兼容性**:
- [ ] iOS设备测试
- [ ] Android设备测试
- [ ] 不同屏幕尺寸测试

**基础库版本测试**:
- [ ] 基础库版本检查(3.14.1)
- [ ] 向下兼容性检查

---

## 📝 测试报告记录

### 测试记录模板

建议您测试时记录以下信息:

```markdown
## 测试记录 - [日期]

### 测试环境
- 设备型号: ____________
- 操作系统: ____________
- 微信版本: ____________
- 测试者: ____________

### 功能测试结果

#### 计算器
- [x] 正常
- [ ] 页面加载慢
- [ ] 计算错误
- [ ] 反馈问题
- **问题说明**: ____________

#### 翻译器
- [x] 正常
- [ ] 页面加载慢
- [ ] 搜索卡顿
- [ ] 翻译错误
- [ ] 复制失败
- **问题说明**: ____________

#### 地域习俗
- [x] 正常
- [ ] 页面加载慢
- [ ] 省份切换失败
- [ ] 数据显示错误
- **问题说明**: ____________

#### 统计
- [x] 正常
- [ ] 页面加载慢
- [ ] 数据显示错误
- **问题说明**: ____________

### 性能测试
- 页面加载速度: ⭐⭐⭐⭐⭐⭐ (1-5星)
- 搜索响应速度: ⭐⭐⭐⭐⭐⭐ (1-5星)
- 整体流畅度: ⭐⭐⭐⭐⭐⭐ (1-5星)

### 改进建议
1. ____________
2. ____________
3. ____________
```

---

## 🚨 常见问题排查

### 问题一: 页面无法打开

**可能原因**:
1. AppID配置错误
2. project.config.json格式错误
3. 基础库版本过低

**解决方案**:
1. 检查AppID是否正确配置
2. 确认project.config.json中appId字段
3. 更新基础库版本到3.14.1或更高

### 问题二: 省份切换报错

**错误信息**:
```
ReferenceError: that is not defined
```

**已修复**:
- ✅ customs.js中async函数已修复
- ✅ 使用`page`变量替代`that`

**验证方法**:
- 切换不同省份
- 观察是否还有报错
- 检查控制台日志

### 问题三: 数据加载失败

**错误信息**:
```
加载地域数据失败: Error: ...
```

**预期行为**:
- 显示"使用默认数据"提示
- 使用默认数据继续运行

**验证方法**:
- 尝试切换多个省份
- 检查是否都能正常加载

### 问题四: 搜索功能卡顿

**优化措施**:
- ✅ 已添加搜索索引(Map结构)
- ✅ 已添加输入防抖(300ms)
- ✅ 精确匹配O(1),模糊匹配O(n)

**验证方法**:
- 快速输入测试
- 长文本搜索测试
- 多次搜索测试

---

## 📞 提交测试反馈

### 反馈内容模板

测试完成后,请提供以下反馈:

```markdown
## v1.0.0功能测试反馈

### 测试概况
- 测试时间: [YYYY-MM-DD]
- 测试设备: [设备型号]
- 微信版本: [版本号]
- 测试人员: [您的名字]

### 功能测试结果

| 功能模块 | 测试结果 | 问题描述 | 严重程度 |
|---------|---------|---------|----------|
| 计算器 | [通过/失败] | | [高/中/低] |
| 翻译器 | [通过/失败] | | [高/中/低] |
| 地域习俗 | [通过/失败] | | [高/中/低] |
| 统计 | [通过/失败] | | [高/中/低] |

### 性能评估

| 性能指标 | 评分 (1-5星) | 说明 |
|---------|-----------------|------|
| 页面加载速度 | ⭐⭐⭐⭐⭐ | |
| 搜索响应速度 | ⭐⭐⭐⭐⭐ | |
| 整体流畅度 | ⭐⭐⭐⭐⭐ | |

### 用户体验评估

| 体验维度 | 评分 (1-5星) | 说明 |
|---------|-----------------|------|
| 界面美观 | ⭐⭐⭐⭐⭐ | |
| 操作便捷 | ⭐⭐⭐⭐⭐ | |
| 功能完整 | ⭐⭐⭐⭐⭐ | |
| 文档清晰 | ⭐⭐⭐⭐⭐ | |

### 改进建议

1. [具体的改进建议]
2. [具体的改进建议]
3. [具体的改进建议]

### 下一步决策

- [ ] 功能正常,可以开始v1.1.0开发
- [ ] 需要先修复问题
- [ ] 建议调整任务2.1设计方案
- [ ] 其他建议
```

### 提交方式

请将测试反馈通过以下方式之一提交:

**方式A**: 在MonkeyCode平台直接回复
**方式B**: 发送到项目邮箱
**方式C**: 创建GitHub Issue

---

## 📋 v1.1.0开发准备

### 待确认事项

在开始v1.1.0开发前,需要确认以下事项:

- [ ] v1.0.0功能测试通过
- [ ] 性能指标达标
- [ ] 用户体验良好
- [ ] bug修复完成
- [ ] 文档结构清晰

### 开发资源准备

- [ ] 微信开发者工具已安装
- [ ] 测试AppID已配置
- [ ] 最新代码已拉取到本地
- [ ] 开发环境已配置

---

## 📚 相关文档

- [项目文档索引](./INDEX.md) - 完整文档导航
- [v1.1.0开发任务清单](./v1.1.0-development-tasks.md) - 开发任务
- [任务2.1设计文档](./task-2.1-smart-recommendation-design.md) - 智能推荐设计
- [性能分析报告](./performance-analysis.md) - 性能优化记录

---

**文档版本**: v1.0
**最后更新**: 2026-02-05
**状态**: 准备测试

# 红包翻译页面完善计划

## 当前状态
- 基础翻译功能已实现
- 祝福语库已完整（14个分类）
- 搜索功能已优化（使用索引 O(1)查找）

---

## P0级任务（必须完成）

### 1. 翻译历史记录
- **功能描述**：记录用户查看的翻译历史
- **数据结构**：
  ```javascript
  {
    id: String,        // 历史记录ID
    phrase: String,    // 输入的祝福语
    result: Object,   // 翻译结果
    timestamp: Number, // 查询时间戳
    category: String     // 所属分类
  }
  ```
- **实现要点**：
  - 使用 `wx.getStorageSync('translation_history')` 存储
  - 限制历史记录数量（最多100条）
  - 按时间倒序排列
  - 支持删除单条记录
  - 支持清空历史
- **UI设计**：
  - 添加"历史"按钮（入口）
  - 历史列表展示（最近10条）
  - 显示查询时间（如"2小时前"）

### 2. 收藏功能
- **功能描述**：收藏常用祝福语，方便快速查找
- **数据结构**：
  ```javascript
  {
    id: String,        // 收藏ID
    phrase: Object,   // 祝福语对象
    timestamp: Number  // 收藏时间
  }
  ```
- **实现要点**：
  - 使用 `wx.getStorageSync('favorite_phrases')` 存储
  - 限制收藏数量（最多50条）
  - 在祝福语卡片上添加"收藏"按钮
  - 收藏后按钮显示"已收藏"
  - 单独的"我的收藏"入口查看

---

## P1级任务（建议完成）

### 1. 多条件筛选
- **功能描述**：支持场景+类型组合筛选
- **筛选维度**：
  - 场景：婚礼、生日、葬礼、春节、开业等
  - 类型：传统、现代、创意、趣味
- **UI设计**：
  - 双栏筛选器（场景选择 + 类型选择）
  - 选择后实时更新祝福语列表

### 2. 每日推荐
- **功能描述**：根据日期推荐相关节日祝福语
- **实现要点**：
  - 获取当前日期
  - 判断节日（春节、中秋、国庆等）
  - 显示"今日推荐"横幅
  - 推荐顶部显示节日标识

---

## P2级任务（可选完成）

### 1. 语音输入支持
- **功能描述**：使用微信语音识别 API 实现语音输入
- **技术方案**：
  - 调用 `wx.startRecord()` 开始录音
  - 调用 `wx.stopRecord()` 停止录音
  - 调用 `wx.cloud.callFunction()` 语音识别
- **UI设计**：
  - 输入框旁添加"麦克风"按钮
  - 录音状态指示

### 2. 分享卡片生成
- **功能描述**：生成精美的分享卡片图片
- **技术方案**：
  - 使用 Canvas 绘制卡片
  - 包含：传统祝福语、现代翻译、装饰元素
  - 导出为临时图片
- **样式选项**：
  - 多种卡片模板选择
  - 不同节日主题

---

## 数据管理规范

### 祝福语数据结构
```javascript
{
  id: String,              // 唯一ID
  traditional: String,      // 传统祝福语
  modern: String,          // 现代翻译
  meaning: String,         // 含义解释
  usage: String,          // 适用场景
  category: String,        // 分类
  tags: Array<String>      // 标签（如：喜庆、庄重、创意）
}
```

### 翻译历史数据结构
```javascript
{
  id: String,
  phrase: String,
  result: {
    traditional: String,
    modern: String,
    meaning: String,
    usage: String,
    category: String
  },
  timestamp: Number,
  category: String
}
```

---

## 实施顺序

| 阶段 | 任务 | 预计时间 |
|------|------|---------|
| 第一周 | 翻译历史记录 | 2天 |
| 第一周 | 收藏功能 | 1天 |
| 第二周 | 多条件筛选 | 2天 |
| 第二周 | 每日推荐 | 1天 |

---

**文档版本**: v1.0
**创建日期**: 2026-02-05
